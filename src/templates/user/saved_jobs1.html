{% extends 'base.html' %}

{% block body %}
<div class="container saved-jobs-container">
    <h1 class="section-heading">Saved Jobs</h1>

    <div class="saved-jobs-list">
        {% if jobs %}
            <p>Here are the jobs you've saved to review later:</p>
            {% for job in jobs %}
                <div class="job-card card mb-4 shadow-sm">
                    <div class="card-body">
                        <div class="job-header">
                            <h4 class="card-title">{{ job.job_title }}</h4>
                            <span class="bookmark-icon bookmarked" onclick="toggleSaveJob('{{ job.job_id }}')">&#9733; Unsave</span>
                        </div>
                        <p class="card-text"><strong>Company:</strong> {{ job.company_name }}</p>
                        <p class="card-text"><strong>Location:</strong> {{ job.city }}, {{ job.country }}</p>
                        <a href="{{ url_for('user_views.view_job_details', job_id=job.job_id) }}" class="btn btn-outline-primary view-details-button">View Job Details</a>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <div class="no-jobs-message">
                <p>You haven't saved any jobs yet!</p>
                <p>Save some now, so you can check back on them later.</p>
                <a href="{{ url_for('user_views.view_all_jobs') }}" class="btn btn-primary see-all-jobs-button">See All Jobs</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function toggleSaveJob(jobId) {
        fetch(`/user/jobs/${jobId}/remove_bookmark`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                {% if csrf_token %}
                'X-CSRFToken': '{{ csrf_token() }}'
                {% endif %}
            },
        })
        .then(response => {
            if (response.ok) {
                console.log("Job unsaved!");
                window.location.reload();
            } else {
                alert('Failed to update job save status.');
            }
        })
        .catch(error => {
            console.error('Error updating job save status:', error);
        });
    }
</script>
{% endblock %}

<style>
    /* Container */
    .saved-jobs-container {
        margin-top: 30px;
        background-color: #f9f9f9;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
    }

    /* Section Title */
    .section-heading {
        font-family: 'Roboto', sans-serif;
        font-size: 28px;
        font-weight: bold;
        color: #333;
        margin-bottom: 20px;
    }

    /* Saved Jobs List */
    .saved-jobs-list {
        margin-top: 20px;
    }

    /* Job Card */
    .job-card {
        background-color: #ffffff;
        border-radius: 8px;
        transition: transform 0.2s ease-in-out;
    }

    .job-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    }

    .card-body {
        padding: 20px;
    }

    /* Job Header */
    .job-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    /* Job Title */
    .card-title {
        font-size: 22px;
        font-weight: 600;
        color: #0073b1;
    }

    /* Bookmark Icon */
    .bookmark-icon {
        font-size: 20px;
        cursor: pointer;
        color: #f39c12;  /* Gold color for saved jobs */
        font-weight: bold;
        text-decoration: none;
    }

    /* Job Details */
    .card-text {
        font-size: 16px;
        color: #555;
    }

    /* View Details Button */
    .view-details-button {
        margin-top: 15px;
        border-radius: 5px;
        transition: background-color 0.2s, color 0.2s;
    }

    .view-details-button:hover {
        background-color: #0073b1;
        color: white;
    }

    /* No Jobs Message */
    .no-jobs-message {
        text-align: center;
        margin-top: 30px;
        color: #666;
    }

    .see-all-jobs-button {
        margin-top: 15px;
        padding: 10px 20px;
        font-size: 16px;
    }
</style>
